<!DOCTYPE html>
<html lang="zh-CN,en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yihangwe.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content=".lang-content {width: 100%;overflow: hidden;}.lang-content:not(:first-child) {display: none;}åˆ‡æ¢ä¸­æ–‡  Programming ModelInput and Output:  Takes a set of input key&#x2F;value pairs. Produces a set of outp">
<meta property="og:type" content="article">
<meta property="og:title" content="MapReduce">
<meta property="og:url" content="https://yihangwe.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/2024/11/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/MapReduce/index.html">
<meta property="og:site_name" content="EthanWeee">
<meta property="og:description" content=".lang-content {width: 100%;overflow: hidden;}.lang-content:not(:first-child) {display: none;}åˆ‡æ¢ä¸­æ–‡  Programming ModelInput and Output:  Takes a set of input key&#x2F;value pairs. Produces a set of outp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yihangwe.github.io/images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/mapred_exe_overview.png">
<meta property="og:image" content="https://yihangwe.github.io/images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/bg_bm_rounding.png">
<meta property="og:image" content="https://yihangwe.github.io/images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/mapred_exe_overview.png">
<meta property="og:image" content="https://yihangwe.github.io/images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/bg_bm_rounding.png">
<meta property="article:published_time" content="2024-11-22T08:00:00.000Z">
<meta property="article:modified_time" content="2025-06-18T07:31:28.190Z">
<meta property="article:author" content="Yihang Wei">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yihangwe.github.io/images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/mapred_exe_overview.png">

<link rel="canonical" href="https://yihangwe.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/2024/11/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/MapReduce/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MapReduce | EthanWeee</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start --><script>(function() {function calculateHeight(element) {let height = 0;const items = element.children;for (let i = 0; i < items.length; i++) {height += items[i].offsetHeight || 25;const child = items[i].querySelector(".nav-child");if (child && child.style.display !== "none") {height += calculateHeight(child);}}return height;}function generateToc(lang, container) {const content = document.getElementById(lang + "-content");if (!content) return;const headers = Array.from(content.querySelectorAll("h1, h2, h3, h4, h5, h6"));if (headers.length === 0) return;const ol = document.createElement("ol");ol.className = "nav";let currentLevel = 1;let currentOl = ol;let stack = [ol];let counters = [0, 0, 0, 0, 0, 0];headers.forEach((header, index) => {const level = parseInt(header.tagName[1]);counters[level - 1]++;for (let i = level; i < 6; i++) counters[i] = 0;const li = document.createElement("li");li.className = "nav-item nav-level-" + level;if (level === 1 && index === 0) {li.classList.add("active", "active-current");}const link = document.createElement("a");link.className = "nav-link";if (level === 1 && index === 0) link.classList.add("active");link.href = "#" + header.id;const numSpan = document.createElement("span");numSpan.className = "nav-number";numSpan.textContent = counters.slice(0, level).filter(n => n > 0).join(".");const textSpan = document.createElement("span");textSpan.className = "nav-text";textSpan.textContent = header.textContent;link.appendChild(numSpan);link.appendChild(document.createTextNode(" "));link.appendChild(textSpan);li.appendChild(link);if (level > currentLevel) {const newOl = document.createElement("ol");newOl.className = "nav-child";if (currentLevel === 1) {newOl.style.display = "block";stack[currentLevel - 1].lastElementChild.classList.add("active");}stack[currentLevel - 1].lastElementChild.appendChild(newOl);stack[level - 1] = newOl;currentOl = newOl;} else if (level < currentLevel) {currentOl = stack[level - 1];}currentOl.appendChild(li);currentLevel = level;});container.appendChild(ol);setTimeout(() => {const navHeight = calculateHeight(ol);ol.style.setProperty("--height", navHeight + "px");const navChilds = ol.getElementsByClassName("nav-child");Array.from(navChilds).forEach(child => {if (child.style.display === "block") {const childHeight = calculateHeight(child);child.style.setProperty("--height", childHeight + "px");}});}, 0);return ol;}function updateActiveHeading() {const activeLang = document.getElementById("en-content").style.display === "block" ? "en" : "zh";const content = document.getElementById(activeLang + "-content");const toc = document.getElementById(activeLang + "-toc");if (!content || !toc) return;const headers = Array.from(content.querySelectorAll("h1, h2, h3, h4, h5, h6"));const scrollPos = window.scrollY + window.innerHeight / 3;let activeHeader = null;for (let i = headers.length - 1; i >= 0; i--) {const header = headers[i];const headerTop = header.getBoundingClientRect().top + window.scrollY;if (headerTop <= scrollPos) {activeHeader = header;break;}}const links = toc.getElementsByClassName("nav-link");Array.from(links).forEach(link => {link.classList.remove("active");const parentLi = link.parentElement;if (parentLi) {parentLi.classList.remove("active", "active-current");}});if (activeHeader) {const activeLink = toc.querySelector(`a[href="#${activeHeader.id}"]`);if (activeLink) {activeLink.classList.add("active");let parent = activeLink.parentElement;while (parent && parent.classList) {if (parent.classList.contains("nav-item")) {parent.classList.add("active");if (parent.classList.contains("nav-level-1")) {parent.classList.add("active-current");}}parent = parent.parentElement;}}}}function initTippy() {document.querySelectorAll(".refplus-num").forEach((ref) => {if (ref._tippy) {ref._tippy.destroy();}let refid = ref.firstChild.href.replace(location.origin+location.pathname,"");let refel = document.querySelector(refid);if (!refel) return;let refnum = refel.dataset.num;let ref_content = refel.innerText.replace(`[${refnum}]`,"");tippy(ref, {content: ref_content,});});}function initToc() {const originalToc = document.querySelector(".post-toc-wrap");if (!originalToc || !document.getElementById("langToggle")) return;const tocContainer = document.createElement("div");tocContainer.className = "post-toc-wrap sidebar-panel sidebar-panel-active";const enToc = document.createElement("div");enToc.id = "en-toc";enToc.className = "post-toc motion-element";enToc.style.display = "block";const zhToc = document.createElement("div");zhToc.id = "zh-toc";zhToc.className = "post-toc motion-element";zhToc.style.display = "none";generateToc("en", enToc);generateToc("zh", zhToc);tocContainer.appendChild(enToc);tocContainer.appendChild(zhToc);originalToc.parentNode.replaceChild(tocContainer, originalToc);window.addEventListener("scroll", updateActiveHeading);setTimeout(updateActiveHeading, 0);}window.toggleLanguage = function() {const enContent = document.getElementById("en-content");const zhContent = document.getElementById("zh-content");const enToc = document.getElementById("en-toc");const zhToc = document.getElementById("zh-toc");const button = document.getElementById("langToggle");if (!enContent || !zhContent || !enToc || !zhToc || !button) return;const isEnglish = enContent.style.display === "block";enContent.style.display = isEnglish ? "none" : "block";zhContent.style.display = isEnglish ? "block" : "none";enToc.style.display = isEnglish ? "none" : "block";zhToc.style.display = isEnglish ? "block" : "none";button.querySelector(".button-text").textContent = isEnglish ? "Switch to English" : "åˆ‡æ¢ä¸­æ–‡";setTimeout(updateActiveHeading, 0);setTimeout(initTippy, 100);};document.addEventListener("DOMContentLoaded", function() {initToc();setTimeout(initTippy, 3000);});})();</script><style>.post-toc { transition: all 0.2s ease-in-out; }.post-toc .nav { padding-left: 0; }.post-toc .nav-child { padding-left: 1em; }.post-toc .nav-item { line-height: 1.8; }.post-toc .nav-link { color: #555; }.post-toc .nav-link:hover { color: #222; }.post-toc .nav-link.active { color: #fc6423; }.post-toc .active > .nav-link { color: #fc6423; }.post-toc .active-current > .nav-link { color: #fc6423; }</style><!-- hexo injector head_end end --><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">EthanWeee</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yihangwe.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/2024/11/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/MapReduce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yihang Wei">
      <meta itemprop="description" content="èšç„¦äºä¸ªäººçš„å­¦ä¹ ä¸æˆé•¿å†ç¨‹ï¼Œæ—¨åœ¨ç³»ç»Ÿè®°å½•åœ¨åç«¯å¼€å‘ã€æ•°æ®åº“ç­‰é¢†åŸŸçš„æ¢ç´¢ä¸å®è·µã€‚">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EthanWeee">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MapReduce
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-11-22 00:00:00" itemprop="dateCreated datePublished" datetime="2024-11-22T00:00:00-08:00">2024-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-06-18 00:31:28" itemprop="dateModified" datetime="2025-06-18T00:31:28-07:00">2025-06-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">æ•°æ®åº“ç³»ç»Ÿ</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <style>.lang-content {width: 100%;overflow: hidden;}.lang-content:not(:first-child) {display: none;}</style><div style="text-align: right; margin: 0 0 20px auto; max-width: 200px;"><button id="langToggle" onclick="toggleLanguage()" class="lang-switch-btn" style="width: 100%;padding: 10px 20px;border-radius: 8px;border: 2px solid #2c3e50;background-color: #fff;cursor: pointer;color: #2c3e50;font-size: 15px;transition: all 0.3s ease;display: flex;align-items: center;justify-content: center;gap: 8px;box-shadow: 0 2px 4px rgba(0,0,0,0.1);"><span class="button-text">åˆ‡æ¢ä¸­æ–‡</span></button></div>

<div id="en-content" class="lang-content" style="display: block;"><h1 id="Programming-Model"><a href="#Programming-Model" class="headerlink" title="Programming Model"></a>Programming Model</h1><p>Input and Output:</p>
<ul>
<li>Takes a <strong>set of input key&#x2F;value pairs</strong>.</li>
<li>Produces a <strong>set of output key&#x2F;value pairs</strong>.</li>
</ul>
<p>User-Defined Functions:</p>
<ul>
<li><strong>Map Function</strong>:<ul>
<li>Written by the user.</li>
<li>Processes each input key&#x2F;value pair.</li>
<li>Generates a set of <strong>intermediate key&#x2F;value pairs</strong>.</li>
</ul>
</li>
<li><strong>Reduce Function</strong>:<ul>
<li>Also written by the user.</li>
<li>Takes an intermediate key <code>I</code> and a <strong>set of values</strong> associated with it.</li>
<li>Merges these values to produce a <strong>smaller set</strong> of output values, often zero or one value.</li>
</ul>
</li>
</ul>
<p>Intermediate Data Handling:</p>
<ul>
<li>The <strong>MapReduce library</strong> groups intermediate values by their key (<code>I</code>) and sends them to the Reduce function.</li>
<li>Intermediate values are supplied to the Reduce function using an <strong>iterator</strong>, enabling efficient handling of data sets that are too large to fit into memory.</li>
</ul>
<p>Fault Tolerance and Scalability:</p>
<ul>
<li>By breaking tasks into smaller, independent computations, MapReduce ensures scalability and fault tolerance, even in large distributed environments.</li>
</ul>
<h1 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h1><p><img src="/../../images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/mapred_exe_overview.png" alt="img"></p>
<p>æ•°æ®åˆ†å‰²ä¸ä»»åŠ¡åˆ†é…ï¼š</p>
<ul>
<li>è¾“å…¥æ•°æ®åˆ’åˆ†ï¼šMapReduce åº“å°†è¾“å…¥æ–‡ä»¶è‡ªåŠ¨åˆ†å‰²æˆ M ä¸ªç‰‡æ®µï¼ˆé€šå¸¸æ¯ä¸ªç‰‡æ®µ16MBåˆ°64MBï¼Œå¯ç”±ç”¨æˆ·æ§åˆ¶ï¼‰ã€‚</li>
<li>å¯åŠ¨ç¨‹åºå®ä¾‹ï¼šåœ¨é›†ç¾¤ä¸­å¯åŠ¨å¤šä¸ªç¨‹åºå‰¯æœ¬ã€‚</li>
<li>è§’è‰²åˆ†é…ï¼šå…¶ä¸­ä¸€ä¸ªç¨‹åºå®ä¾‹è¢«æŒ‡å®šä¸ºä¸»èŠ‚ç‚¹ï¼ˆmasterï¼‰ï¼Œå…¶ä½™çš„ä½œä¸ºå·¥ä½œèŠ‚ç‚¹ï¼ˆworkersï¼‰ã€‚</li>
</ul>
<p>ä»»åŠ¡è°ƒåº¦ï¼š</p>
<ul>
<li>ä¸»èŠ‚ç‚¹çš„èŒè´£ï¼šä¸»èŠ‚ç‚¹è´Ÿè´£ç®¡ç† M ä¸ª map ä»»åŠ¡å’Œ R ä¸ª reduce ä»»åŠ¡ã€‚</li>
<li>ä»»åŠ¡åˆ†é…ï¼šä¸»èŠ‚ç‚¹å°†ç©ºé—²çš„å·¥ä½œèŠ‚ç‚¹åˆ†é…ç»™ map ä»»åŠ¡æˆ– reduce ä»»åŠ¡ã€‚</li>
</ul>
<p>Map é˜¶æ®µï¼š</p>
<ul>
<li>è¯»å–æ•°æ®ï¼šè¢«åˆ†é… map ä»»åŠ¡çš„å·¥ä½œèŠ‚ç‚¹è¯»å–å¯¹åº”çš„è¾“å…¥ç‰‡æ®µã€‚</li>
<li>å¤„ç†æ•°æ®ï¼šè§£æå‡ºé”®&#x2F;å€¼å¯¹ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„ Map å‡½æ•°ã€‚</li>
<li>ç”Ÿæˆä¸­é—´ç»“æœï¼š<strong>Map å‡½æ•°äº§ç”Ÿçš„ä¸­é—´é”®&#x2F;å€¼å¯¹ä¼šå­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸­ã€‚</strong></li>
</ul>
<p>ä¸­é—´æ•°æ®å¤„ç†ï¼š</p>
<ul>
<li>å†™å…¥æœ¬åœ°ç£ç›˜ï¼š**ç¼“å­˜çš„ä¸­é—´ç»“æœä¼šå®šæœŸå†™å…¥æœ¬åœ°ç£ç›˜ï¼Œ**<strong>å¹¶æ ¹æ®åˆ†åŒºå‡½æ•°åˆ’åˆ†ä¸º R ä¸ªåŒºåŸŸã€‚</strong></li>
<li>é€šçŸ¥ä¸»èŠ‚ç‚¹ï¼šå·¥ä½œèŠ‚ç‚¹å°†è¿™äº›ä¸­é—´æ•°æ®çš„ä½ç½®å‘ŠçŸ¥ä¸»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹è´Ÿè´£å°†è¿™äº›ä¿¡æ¯ä¼ é€’ç»™ reduce å·¥ä½œèŠ‚ç‚¹ã€‚</li>
</ul>
<p>Reduce é˜¶æ®µå‡†å¤‡ï¼š</p>
<ul>
<li>è¯»å–ä¸­é—´æ•°æ®ï¼šreduce å·¥ä½œèŠ‚ç‚¹æ”¶åˆ°ä¸»èŠ‚ç‚¹çš„é€šçŸ¥åï¼Œé€šè¿‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰ä» map å·¥ä½œèŠ‚ç‚¹çš„æœ¬åœ°ç£ç›˜è¯»å–ä¸­é—´æ•°æ®ã€‚</li>
<li>æ’åºæ•°æ®ï¼šreduce å·¥ä½œèŠ‚ç‚¹å°†æ‰€æœ‰ä¸­é—´æ•°æ®æŒ‰é”®æ’åºï¼Œä»¥ç¡®ä¿ç›¸åŒçš„é”®èšé›†åœ¨ä¸€èµ·ã€‚å¦‚æœæ•°æ®é‡è¿‡å¤§ï¼Œæ— æ³•å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ï¼Œä¼šé‡‡ç”¨å¤–éƒ¨æ’åºã€‚</li>
</ul>
<p>Reduce é˜¶æ®µï¼š</p>
<ul>
<li>æ‰§è¡Œ Reduce å‡½æ•°ï¼šreduce å·¥ä½œèŠ‚ç‚¹éå†æ’åºåçš„ä¸­é—´æ•°æ®ï¼Œå¯¹äºæ¯ä¸ªå”¯ä¸€çš„ä¸­é—´é”®ï¼Œå°†é”®å’Œå¯¹åº”çš„å€¼åˆ—è¡¨ä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„ Reduce å‡½æ•°ã€‚</li>
<li>ç”Ÿæˆæœ€ç»ˆè¾“å‡ºï¼šReduce å‡½æ•°çš„è¾“å‡ºè¢«è¿½åŠ åˆ°è¯¥ reduce åˆ†åŒºçš„æœ€ç»ˆè¾“å‡ºæ–‡ä»¶ä¸­ã€‚</li>
</ul>
<p>ä»»åŠ¡å®Œæˆä¸ç»“æœè¿”å›ï¼š</p>
<ul>
<li>ä»»åŠ¡ç›‘æ§ï¼šå½“æ‰€æœ‰çš„ map å’Œ reduce ä»»åŠ¡éƒ½å®Œæˆåï¼Œä¸»èŠ‚ç‚¹ä¼šå”¤é†’ç”¨æˆ·ç¨‹åºã€‚</li>
<li>è¿”å›ç»“æœï¼šæ­¤æ—¶ï¼Œç”¨æˆ·ç¨‹åºä¸­çš„ MapReduce è°ƒç”¨è¿”å›ï¼Œç”¨æˆ·å¯ä»¥è·å– R ä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œæ¯ä¸ª reduce ä»»åŠ¡å¯¹åº”ä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ã€‚</li>
</ul>
<p>é¢å¤–è¯´æ˜ï¼š</p>
<ul>
<li>æ•°æ®å¤„ç†é“¾ï¼šé€šå¸¸ç”¨æˆ·ä¸éœ€è¦å°†è¿™ R ä¸ªè¾“å‡ºæ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶å¯ä»¥ç›´æ¥ä½œä¸ºä¸‹ä¸€ä¸ª MapReduce è°ƒç”¨çš„è¾“å…¥ï¼Œæˆ–è€…è¢«èƒ½å¤Ÿå¤„ç†å¤šæ–‡ä»¶è¾“å…¥çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚</li>
<li>æµç¨‹å›¾å‚è€ƒï¼šä¸Šå›¾ğŸ‘†ç”¨äºå±•ç¤º MapReduce æ“ä½œçš„æ•´ä½“æµç¨‹ï¼Œå¯¹åº”ä¸Šé¢çš„æ­¥éª¤1åˆ°7ã€‚</li>
</ul>
<h2 id="Master-Data-Structure"><a href="#Master-Data-Structure" class="headerlink" title="Master Data Structure"></a>Master Data Structure</h2><p>Task State Tracking:</p>
<ul>
<li>For each <strong>map</strong> and <strong>reduce task</strong>, the master stores:<ul>
<li><strong>State</strong>:<ul>
<li><code>idle</code>: Task is yet to be assigned.</li>
<li><code>in-progress</code>: Task is currently being executed.</li>
<li><code>completed</code>: Task has finished execution.</li>
</ul>
</li>
<li><strong>Worker Identity</strong>: The worker machine handling the task (for non-idle tasks).</li>
</ul>
</li>
</ul>
<p>Intermediate Data Management:</p>
<ul>
<li>The master acts as the <strong>conduit</strong> for transferring intermediate data from map tasks to reduce tasks.</li>
<li>For each completed map task:<ul>
<li>It records the <strong>locations</strong> and <strong>sizes</strong> of the <code>R</code> intermediate file regions generated.</li>
<li>This data is crucial for reduce tasks to fetch intermediate results from the corresponding map workers.</li>
</ul>
</li>
</ul>
<p>Dynamic Updates:</p>
<ul>
<li>As map tasks finish, the master continuously updates its records of intermediate file locations and sizes.</li>
<li>These updates are incrementally pushed to reduce workers that are currently in-progress.</li>
</ul>
<h2 id="Fault-Tolerance"><a href="#Fault-Tolerance" class="headerlink" title="Fault Tolerance"></a>Fault Tolerance</h2><p>Worker Failure</p>
<ul>
<li><strong>Failure Detection</strong>:<ul>
<li>The <strong>master node</strong> periodically <strong>pings every worker</strong>.</li>
<li>If a worker does not respond within a certain timeframe, the master marks the worker as <strong>failed</strong>.</li>
</ul>
</li>
<li><strong>Task Rescheduling</strong>:<ul>
<li><strong>Map Tasks</strong>:<ul>
<li><strong>Completed Map Tasks</strong>:<ul>
<li>If the failed worker had completed a map task, its output becomes inaccessible (stored on the failed machineâ€™s local disk).</li>
<li>These tasks are reset to their <strong>idle state</strong> and re-executed on other workers.</li>
</ul>
</li>
<li><strong>In-Progress Map Tasks</strong>:<ul>
<li>Similarly, in-progress tasks are marked as idle and reassigned to available workers.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Reduce Tasks</strong>:<ul>
<li><strong>Completed Reduce Tasks</strong>:<ul>
<li>These do not require re-execution, as their output is stored in a <strong>global file system</strong>, which remains accessible despite the failure.</li>
</ul>
</li>
<li><strong>In-Progress Reduce Tasks</strong>:<ul>
<li>å¦‚æœæŸäº› reduce èŠ‚ç‚¹å°šæœªè¯»å–ä¸­é—´æ•°æ®ï¼Œå®ƒä»¬ä¼šä»æ–°çš„æ‰§è¡Œç»“æœä¸­è¯»å–æ•°æ®ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>Data Coordination</strong>:<ul>
<li>When a map task is re-executed on a new worker:<ul>
<li><strong>Notification</strong>: All reduce workers are informed of the re-execution.</li>
<li><strong>Data Redirection</strong>: Reduce workers that have not yet fetched the intermediate data from the failed worker will instead fetch it from the new worker.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Master Failure</p>
<p>It is easy to make the master write periodic checkpoints of the master data structures described above. If the master task dies, a new copy can be started from the last checkpointed state. However, given that there is only a single master, its failure is unlikely; <strong>therefore our current implementation aborts the MapReduce computation if the master fails.</strong> Clients can check for this condition and retry the MapReduce operation if they desire.</p>
<h2 id="Locality-æ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–"><a href="#Locality-æ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–" class="headerlink" title="Locality æ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–"></a>Locality æ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–</h2><p>å­˜å‚¨è®¾è®¡ï¼š æ•°æ®å­˜å‚¨åœ¨ Google æ–‡ä»¶ç³»ç»Ÿ (GFS) ä¸­ã€‚ GFS å°†æ¯ä¸ªæ–‡ä»¶åˆ†å‰²ä¸º 64 MB çš„å—ï¼Œå¹¶åœ¨ä¸åŒçš„æœºå™¨ä¸Šä¿å­˜å¤šä¸ªå‰¯æœ¬ï¼ˆé€šå¸¸æ˜¯ 3 ä¸ªï¼‰ã€‚</p>
<p>ä»»åŠ¡è°ƒåº¦ä¼˜å…ˆçº§ï¼š</p>
<ul>
<li>ä¼˜å…ˆæœ¬åœ°åŒ–è°ƒåº¦ï¼šThe master node prioritizes assigning map tasks to workers that are on the same machine containing the replica of the data block.</li>
<li>æ¬¡ä¼˜è°ƒåº¦ï¼šIf local scheduling is not possible (e.g., the worker with the data block is busy), the master assigns the task to a machine near the replica, such as within the same rack or data center.</li>
</ul>
<p>å®é™…æ•ˆæœï¼š åœ¨è¿è¡Œå¤§å‹ MapReduce æ“ä½œæ—¶ï¼Œå¤§éƒ¨åˆ†è¾“å…¥æ•°æ®ä¼šä»æœ¬åœ°ç£ç›˜è¯»å–ã€‚ å› ä¸ºæ•°æ®æœ¬åœ°åŒ–ï¼Œå‡å°‘äº†è·¨ç½‘ç»œä¼ è¾“çš„æ•°æ®é‡ï¼Œä»è€ŒèŠ‚çœç½‘ç»œå¸¦å®½ã€‚</p>
<h2 id="Task-Granularity"><a href="#Task-Granularity" class="headerlink" title="Task Granularity"></a>Task Granularity</h2><ol>
<li>Map å’Œ Reduce é˜¶æ®µçš„åˆ’åˆ†<ol>
<li>ä»»åŠ¡æ•°é‡ (M å’Œ R)ï¼š Map é˜¶æ®µè¢«åˆ’åˆ†ä¸º M ä¸ªä»»åŠ¡ã€‚ Reduce é˜¶æ®µè¢«åˆ’åˆ†ä¸º R ä¸ªä»»åŠ¡ã€‚</li>
<li>åˆ’åˆ†åŸåˆ™ï¼šç†æƒ³æƒ…å†µä¸‹ï¼ŒM å’Œ R çš„æ•°é‡åº”è¯¥è¿œå¤§äºå·¥ä½œèŠ‚ç‚¹çš„æ•°é‡ï¼ˆå³æœºå™¨çš„æ•°é‡ï¼‰ã€‚</li>
</ol>
</li>
<li>å¤šä»»åŠ¡åˆ’åˆ†çš„å¥½å¤„<ol>
<li>åŠ¨æ€è´Ÿè½½å‡è¡¡ï¼š æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹å¯æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè¿™æ ·å¯ä»¥åŠ¨æ€è°ƒæ•´ä»»åŠ¡åˆ†é…ï¼Œé¿å…æŸäº›èŠ‚ç‚¹è¿‡è½½æˆ–é—²ç½®ã€‚</li>
<li>æ•…éšœæ¢å¤åŠ é€Ÿï¼š å¦‚æœæŸä¸ªå·¥ä½œèŠ‚ç‚¹å¤±è´¥ï¼Œå·²å®Œæˆçš„å¤šä¸ªä»»åŠ¡å¯ä»¥åˆ†æ•£åˆ°å…¶ä»–èŠ‚ç‚¹é‡æ–°æ‰§è¡Œï¼Œæ¢å¤é€Ÿåº¦æ›´å¿«ã€‚</li>
</ol>
</li>
<li>ä»»åŠ¡åˆ’åˆ†çš„å®é™…é™åˆ¶<ol>
<li>è°ƒåº¦å¼€é”€ï¼š ä¸»èŠ‚ç‚¹éœ€è¦è¿›è¡Œ O(M + R) æ¬¡è°ƒåº¦å†³ç­–ï¼Œä¸”éœ€è¦å­˜å‚¨ O(M Ã— R) çš„çŠ¶æ€ä¿¡æ¯ã€‚ è™½ç„¶æ¯å¯¹ map&#x2F;reduce ä»»åŠ¡å¯¹ä»…å ç”¨çº¦ 1 å­—èŠ‚å†…å­˜ï¼Œä½†è¿‡å¤šä»»åŠ¡ä¼šå¢åŠ å†…å­˜éœ€æ±‚å’Œè°ƒåº¦å¤æ‚æ€§ã€‚</li>
<li>è¾“å‡ºæ–‡ä»¶é™åˆ¶ï¼š R çš„å¤§å°å¾€å¾€å—åˆ°ç”¨æˆ·éœ€æ±‚é™åˆ¶ï¼Œå› ä¸ºæ¯ä¸ª reduce ä»»åŠ¡ä¼šç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„è¾“å‡ºæ–‡ä»¶ã€‚ è¾“å‡ºæ–‡ä»¶è¿‡å¤šä¼šå¯¼è‡´æ–‡ä»¶ç®¡ç†å¤æ‚ã€‚</li>
</ol>
</li>
<li>å®é™…ä»»åŠ¡å¤§å°é€‰æ‹©</li>
<li><ol>
<li>Map é˜¶æ®µï¼š æ¯ä¸ª map ä»»åŠ¡é€šå¸¸å¤„ç† 16 MB åˆ° 64 MB çš„è¾“å…¥æ•°æ®ã€‚ è¿™æ ·çš„ä»»åŠ¡å¤§å°å¯ä»¥å……åˆ†åˆ©ç”¨æ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–ï¼ˆå³å°½é‡ä»æœ¬åœ°ç£ç›˜è¯»å–æ•°æ®ï¼‰ã€‚</li>
<li>Reduce é˜¶æ®µï¼š R é€šå¸¸æ˜¯å·¥ä½œèŠ‚ç‚¹æ•°é‡çš„å‡ å€ï¼Œä»¥å……åˆ†åˆ©ç”¨å¹¶è¡Œèƒ½åŠ›ã€‚ åœ¨ä¸€ä¸ªå…¸å‹çš„å¤§è§„æ¨¡ MapReduce è®¡ç®—ä¸­ï¼š M &#x3D; 200,000ï¼ˆMap é˜¶æ®µä»»åŠ¡æ•°ï¼‰ã€‚ R &#x3D; 5,000ï¼ˆReduce é˜¶æ®µä»»åŠ¡æ•°ï¼‰ã€‚ å·¥ä½œèŠ‚ç‚¹ &#x3D; 2,000ï¼ˆæœºå™¨æ•°é‡ï¼‰ã€‚</li>
</ol>
</li>
</ol>
<h2 id="Backup-Tasks"><a href="#Backup-Tasks" class="headerlink" title="Backup Tasks"></a>Backup Tasks</h2><ol>
<li><p>ä»€ä¹ˆæ˜¯æ‹–åè…¿çš„ä»»åŠ¡ï¼ˆStraggler Tasksï¼‰ï¼Ÿ</p>
<ul>
<li>å®šä¹‰ï¼šA straggler task refers to a task (map or reduce) in a MapReduce job that runs much slower than other tasks, delaying the overall completion of the job.</li>
</ul>
</li>
<li><p>è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li><p>å¤‡ä»½ä»»åŠ¡æœºåˆ¶ï¼šå½“ MapReduce è®¡ç®—æ¥è¿‘å®Œæˆæ—¶ï¼Œä¸»èŠ‚ç‚¹ä¼šä¸ºæœªå®Œæˆçš„ä»»åŠ¡å®‰æ’å¤‡ä»½æ‰§è¡Œï¼ˆBackup Executionsï¼‰ã€‚åŒä¸€ä»»åŠ¡çš„å¤šä¸ªå‰¯æœ¬åœ¨ä¸åŒçš„å·¥ä½œèŠ‚ç‚¹ä¸ŠåŒæ—¶è¿è¡Œã€‚åªè¦å…¶ä¸­ä¸€ä¸ªå‰¯æœ¬å®Œæˆï¼Œä»»åŠ¡å³è¢«æ ‡è®°ä¸ºå®Œæˆã€‚</p>
</li>
<li><p>èµ„æºå¼€é”€ï¼šè°ƒæ•´åçš„æœºåˆ¶åªå¢åŠ å°‘é‡ï¼ˆé€šå¸¸æ˜¯å‡ ä¸ªç™¾åˆ†ç‚¹ï¼‰çš„è®¡ç®—èµ„æºä½¿ç”¨ã€‚é€šè¿‡å¤‡ä»½æ‰§è¡Œï¼Œèƒ½å¤Ÿæ˜¾è‘—ç¼©çŸ­æ€»æ‰§è¡Œæ—¶é—´ã€‚</p>
</li>
</ul>
</li>
</ol>
<h1 id="Refinement"><a href="#Refinement" class="headerlink" title="Refinement"></a>Refinement</h1><p><strong>Partitioning Function</strong></p>
<ol>
<li>Reduce ä»»åŠ¡ä¸åˆ†åŒº<ol>
<li>ç”¨æˆ·é€šè¿‡è®¾ç½® R æ¥æŒ‡å®šéœ€è¦çš„ reduce ä»»åŠ¡æ•°æˆ–è¾“å‡ºæ–‡ä»¶æ•°ã€‚</li>
<li>æ•°æ®åœ¨è¿™äº› reduce ä»»åŠ¡ä¹‹é—´åˆ†åŒºï¼Œåˆ†åŒºæ–¹å¼å–å†³äºåˆ†åŒºå‡½æ•°ï¼ˆpartitioning functionï¼‰ã€‚</li>
</ol>
</li>
<li>é»˜è®¤åˆ†åŒºæ–¹å¼<ol>
<li>é»˜è®¤ä½¿ç”¨ å“ˆå¸Œå‡½æ•°ï¼ˆhash functionï¼‰ï¼š</li>
<li>åˆ†åŒºè§„åˆ™ï¼šhash(key) mod Rã€‚</li>
<li>ä¼˜åŠ¿ï¼šé€šå¸¸èƒ½å®ç°è¾ƒä¸ºå‡è¡¡çš„åˆ†åŒºï¼ˆå³æ•°æ®å‡åŒ€åˆ†å¸ƒåˆ°ä¸åŒ reduce ä»»åŠ¡ä¸­ï¼‰ã€‚</li>
</ol>
</li>
<li>è‡ªå®šä¹‰åˆ†åŒºæ–¹å¼<ol>
<li>æœ‰æ—¶é»˜è®¤çš„å“ˆå¸Œåˆ†åŒºä¸æ»¡è¶³å®é™…éœ€æ±‚ï¼Œéœ€è¦æ ¹æ®ç‰¹å®šé€»è¾‘å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºã€‚ä¾‹å¦‚ï¼šæ•°æ®çš„é”®æ˜¯ URLï¼Œç”¨æˆ·å¸Œæœ›æ‰€æœ‰æ¥è‡ªåŒä¸€ä¸»æœºï¼ˆhostï¼‰çš„æ¡ç›®å­˜å‚¨åœ¨åŒä¸€ä¸ªè¾“å‡ºæ–‡ä»¶ä¸­ã€‚</li>
<li>è§£å†³æ–¹æ¡ˆï¼šç”¨æˆ·å¯ä»¥å®šä¹‰è‡ªå·±çš„åˆ†åŒºå‡½æ•°ï¼Œä¾‹å¦‚ï¼šhash(Hostname(urlkey)) mod Rï¼šæ ¹æ® URL çš„ä¸»æœºååˆ†åŒºã€‚è¿™æ ·ï¼Œæ¥è‡ªåŒä¸€ä¸»æœºçš„æ‰€æœ‰æ¡ç›®ä¼šè¢«åˆ†é…åˆ°ç›¸åŒçš„ reduce ä»»åŠ¡ä¸­ã€‚</li>
</ol>
</li>
</ol>
<p><strong>Ordering Guarantees</strong></p>
<ol>
<li>æ’åºä¿è¯<ol>
<li>åœ¨ MapReduce çš„ æ¯ä¸ªåˆ†åŒºå†…ï¼Œä¸­é—´çš„é”®&#x2F;å€¼å¯¹ï¼ˆkey&#x2F;value pairsï¼‰ä¼šæŒ‰ç…§é”®çš„é€’å¢é¡ºåºè¿›è¡Œå¤„ç†ã€‚</li>
<li>ç›®æ ‡ï¼šç¡®ä¿æ¯ä¸ªåˆ†åŒºçš„è¾“å‡ºæ–‡ä»¶æ˜¯æœ‰åºçš„ã€‚</li>
</ol>
</li>
<li>æ’åºçš„ä½œç”¨<ol>
<li>ç”Ÿæˆæœ‰åºè¾“å‡ºæ–‡ä»¶ï¼šæ¯ä¸ª reduce ä»»åŠ¡ç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶æ˜¯æŒ‰é”®æ’åºçš„ï¼Œç›´æ¥æ”¯æŒæœ‰åºæ•°æ®çš„å­˜å‚¨ã€‚</li>
<li>æ”¯æŒé«˜æ•ˆéšæœºè®¿é—®ï¼šæœ‰åºæ•°æ®ä¾¿äºå¿«é€ŸæŸ¥æ‰¾ï¼Œæ¯”å¦‚é€šè¿‡é”®å€¼å®ç°é«˜æ•ˆçš„éšæœºè®¿é—®ã€‚</li>
<li>ç”¨æˆ·ä¾¿åˆ©ï¼šç”¨æˆ·ä½¿ç”¨è¿™äº›è¾“å‡ºæ–‡ä»¶æ—¶ï¼Œä¸éœ€è¦é¢å¤–æ’åºï¼Œä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚</li>
</ol>
</li>
</ol>
<p><strong>Combiner Function</strong></p>
<ol>
<li>é—®é¢˜èƒŒæ™¯<ol>
<li>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸­é—´é”®é‡å¤ç‡è¾ƒé«˜ï¼Œæ¯ä¸ª map ä»»åŠ¡å¯èƒ½ä¼šç”Ÿæˆå¤§é‡é‡å¤çš„ä¸­é—´é”®è®°å½•ã€‚ç¤ºä¾‹ï¼šåœ¨å•è¯è®¡æ•°ä»»åŠ¡ä¸­ï¼ˆä¾‹å¦‚ ã€ˆthe, 1ã€‰ï¼‰ï¼Œå¸¸è§å•è¯ï¼ˆå¦‚ â€œtheâ€ï¼‰ä¼šé¢‘ç¹å‡ºç°ã€‚</li>
<li>ç»“æœï¼šè¿™äº›é‡å¤è®°å½•éœ€è¦é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°åŒä¸€ä¸ª reduce ä»»åŠ¡ï¼Œå¢åŠ äº†ç½‘ç»œè´Ÿè½½ã€‚</li>
</ol>
</li>
<li>Combiner å‡½æ•°çš„è§£å†³æ–¹æ¡ˆ<ol>
<li>å®šä¹‰ï¼šCombiner æ˜¯ä¸€ä¸ªå¯é€‰çš„ã€å±€éƒ¨çš„èšåˆå‡½æ•°ï¼Œ<strong>ç”¨äºåœ¨ map ä»»åŠ¡æ‰€åœ¨æœºå™¨ä¸Šå¯¹ä¸­é—´æ•°æ®è¿›è¡Œéƒ¨åˆ†åˆå¹¶ã€‚</strong></li>
<li>å·¥ä½œåŸç†ï¼š</li>
<li><ol>
<li>æ‰§è¡Œä½ç½®ï¼šCombiner åœ¨ map ä»»åŠ¡çš„æœºå™¨ä¸Šè¿è¡Œã€‚</li>
<li>åŠŸèƒ½ï¼šå¯¹é‡å¤é”®çš„ä¸­é—´ç»“æœè¿›è¡Œå±€éƒ¨æ±‡æ€»ï¼Œå‡å°‘éœ€è¦ä¼ è¾“çš„æ•°æ®é‡ã€‚</li>
<li>ä¾‹å¦‚ï¼šå°† ã€ˆthe, 1ã€‰ã€ã€ˆthe, 1ã€‰ã€ã€ˆthe, 1ã€‰ åˆå¹¶ä¸º ã€ˆthe, 3ã€‰ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>Combiner å’Œ Reduce çš„åŒºåˆ«<ol>
<li>ç›¸åŒç‚¹ï¼šé€šå¸¸ï¼ŒCombiner çš„ä»£ç ä¸ Reduce å‡½æ•°çš„ä»£ç ç›¸åŒã€‚éƒ½ç”¨äºå¯¹æ•°æ®è¿›è¡Œèšåˆå¤„ç†ã€‚</li>
<li>ä¸åŒç‚¹ï¼š<ol>
<li>Combinerï¼šè¾“å‡ºçš„æ˜¯ä¸­é—´ç»“æœï¼Œæ•°æ®ä¼šç»§ç»­ä¼ é€’ç»™ Reduce ä»»åŠ¡ã€‚</li>
<li>Reduceï¼šè¾“å‡ºçš„æ˜¯æœ€ç»ˆç»“æœï¼Œæ•°æ®å†™å…¥æœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>ä¼˜åŒ–æ•ˆæœ<ol>
<li>å‡å°‘ç½‘ç»œä¼ è¾“é‡ï¼šé€šè¿‡æå‰åˆå¹¶æ•°æ®ï¼ŒCombiner å‡å°‘äº†ä» map ä»»åŠ¡åˆ° reduce ä»»åŠ¡çš„æ•°æ®é‡ã€‚ä¾‹å¦‚ï¼Œä¸ä¼ è¾“ 1000 æ¡ ã€ˆthe, 1ã€‰ï¼Œè€Œæ˜¯åªä¼ è¾“ 1 æ¡ ã€ˆthe, 1000ã€‰ã€‚</li>
<li>æå‡æ€§èƒ½ï¼šå¯¹äºé‡å¤ç‡é«˜çš„ä»»åŠ¡ï¼ŒCombiner èƒ½æ˜¾è‘—åŠ å¿« MapReduce æ“ä½œçš„é€Ÿåº¦ã€‚</li>
</ol>
</li>
</ol>
<p><strong>Input and Output Types</strong></p>
<ol>
<li>è¾“å…¥æ•°æ®æ ¼å¼çš„æ”¯æŒ<ol>
<li>é¢„å®šä¹‰æ ¼å¼ï¼š<ol>
<li>æ–‡æœ¬æ¨¡å¼ï¼ˆtext modeï¼‰ï¼š æ¯è¡Œæ•°æ®è¢«è§†ä¸ºä¸€ä¸ªé”®&#x2F;å€¼å¯¹ã€‚<ol>
<li>é”®ï¼šæ–‡ä»¶ä¸­è¯¥è¡Œçš„åç§»é‡ï¼ˆoffsetï¼‰ã€‚</li>
<li>å€¼ï¼šè¯¥è¡Œçš„å†…å®¹ã€‚ æ’åºé”®&#x2F;å€¼å¯¹æ¨¡å¼ï¼š å­˜å‚¨çš„é”®&#x2F;å€¼å¯¹æŒ‰é”®æ’åºï¼Œä¾¿äºæŒ‰èŒƒå›´å¤„ç†ã€‚</li>
</ol>
</li>
<li>è‡ªåŠ¨åˆ†å‰²èŒƒå›´ï¼š æ¯ç§è¾“å…¥æ ¼å¼éƒ½æœ‰åˆ†å‰²æœºåˆ¶ï¼Œå¯å°†è¾“å…¥æ•°æ®åˆ’åˆ†ä¸ºé€‚åˆ map ä»»åŠ¡å¤„ç†çš„èŒƒå›´ã€‚ ä¾‹å¦‚ï¼Œæ–‡æœ¬æ¨¡å¼ä¼šç¡®ä¿åˆ†å‰²å‘ç”Ÿåœ¨è¡Œè¾¹ç•Œï¼Œè€Œä¸æ˜¯è¡Œä¸­é—´ï¼Œä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</li>
</ol>
</li>
<li>ç”¨æˆ·è‡ªå®šä¹‰æ ¼å¼ï¼š ç”¨æˆ·å¯ä»¥é€šè¿‡å®ç°ç®€å•çš„è¯»å–æ¥å£ï¼ˆreader interfaceï¼‰ï¼Œæ”¯æŒæ–°çš„è¾“å…¥ç±»å‹ã€‚<ol>
<li>éæ–‡ä»¶è¾“å…¥ï¼šæ•°æ®å¯ä»¥æ¥è‡ªå…¶ä»–æ¥æºï¼Œå¦‚æ•°æ®åº“æˆ–å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼Œè€Œä¸ä¸€å®šæ˜¯æ–‡ä»¶ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>è¾“å‡ºæ•°æ®æ ¼å¼çš„æ”¯æŒ<ol>
<li>ç±»ä¼¼è¾“å…¥æ ¼å¼ï¼ŒMapReduce ä¹Ÿæ”¯æŒå¤šç§è¾“å‡ºæ ¼å¼ï¼š<ol>
<li>é¢„å®šä¹‰æ ¼å¼ï¼šæä¾›äº†ä¸€äº›å¸¸ç”¨çš„è¾“å‡ºæ ¼å¼ã€‚</li>
<li>è‡ªå®šä¹‰æ ¼å¼ï¼šç”¨æˆ·å¯ä»¥é€šè¿‡å®ç°æ–°çš„æ¥å£å®šä¹‰è¾“å‡ºæ•°æ®æ ¼å¼ã€‚</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><strong>Skipping Bad Records</strong></p>
<ol>
<li>é—®é¢˜èƒŒæ™¯<ol>
<li>ç”¨æˆ·ä»£ç ç¼ºé™·ï¼šMap æˆ– Reduce å‡½æ•°ä¸­å¯èƒ½å­˜åœ¨é”™è¯¯ï¼ˆå¦‚æŸäº›è®°å½•å¼•å‘å´©æºƒï¼‰ã€‚</li>
<li>ç¡®å®šæ€§å´©æºƒï¼šå¯¹ç‰¹å®šè®°å½•ï¼Œæ¯æ¬¡å¤„ç†éƒ½ä¼šå‘ç”Ÿå´©æºƒã€‚</li>
<li>é—®é¢˜å½±å“ï¼šè¿™ç±»é”™è¯¯å¯èƒ½é˜»æ­¢æ•´ä¸ª MapReduce æ“ä½œå®Œæˆã€‚</li>
<li>æ— æ³•ä¿®å¤çš„æƒ…å†µï¼šé”™è¯¯å¯èƒ½åœ¨ç¬¬ä¸‰æ–¹åº“ä¸­ï¼Œç”¨æˆ·æ— æ³•è®¿é—®æºä»£ç ã€‚</li>
</ol>
</li>
<li>MapReduce æä¾›çš„è§£å†³æ–¹æ¡ˆ<ol>
<li>è·³è¿‡é—®é¢˜è®°å½•ï¼šMapReduce å…è®¸ç³»ç»Ÿæ£€æµ‹å¼•å‘å´©æºƒçš„è®°å½•ï¼Œå¹¶è·³è¿‡è¿™äº›è®°å½•ä»¥ç»§ç»­æ“ä½œã€‚</li>
<li>å®ç°æœºåˆ¶ï¼š<ol>
<li>ä¿¡å·å¤„ç†ï¼šæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹å®‰è£…ä¿¡å·å¤„ç†å™¨ï¼ˆsignal handlerï¼‰ï¼Œæ•è·æ®µé”™è¯¯ï¼ˆsegmentation violationsï¼‰å’Œæ€»çº¿é”™è¯¯ï¼ˆbus errorsï¼‰ã€‚</li>
<li>è®°å½•é”™è¯¯åºå·ï¼šåœ¨è°ƒç”¨ç”¨æˆ·çš„ Map æˆ– Reduce å‡½æ•°ä¹‹å‰ï¼Œç³»ç»Ÿå°†å‚æ•°çš„åºåˆ—å·å­˜å‚¨åœ¨å…¨å±€å˜é‡ä¸­ã€‚</li>
<li>å‘é€é”™è¯¯æŠ¥å‘Šï¼šå¦‚æœç”¨æˆ·ä»£ç è§¦å‘é”™è¯¯ï¼Œä¿¡å·å¤„ç†å™¨ä¼šå‘é€ä¸€ä¸ªâ€œæœ€åçš„å–˜æ¯â€UDP æ•°æ®åŒ…ï¼ŒåŒ…å«å¼•å‘é”™è¯¯çš„è®°å½•åºå·ï¼Œé€šçŸ¥ä¸»èŠ‚ç‚¹ã€‚</li>
<li>ä¸»èŠ‚ç‚¹å†³ç­–ï¼šIf a record causes failures many times, the master node instructs the record to be skipped the next time the task is retried.</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><strong>Local Execution</strong></p>
<ol>
<li>åˆ†å¸ƒå¼è°ƒè¯•çš„æŒ‘æˆ˜<ol>
<li>å¤æ‚æ€§ï¼šMap å’Œ Reduce å‡½æ•°çš„å®é™…è®¡ç®—æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸Šå®Œæˆï¼Œæ¶‰åŠæ•°åƒå°æœºå™¨ã€‚ä¸»èŠ‚ç‚¹åŠ¨æ€åˆ†é…ä»»åŠ¡ï¼Œè°ƒè¯•éš¾ä»¥ç›´æ¥å®šä½é—®é¢˜ã€‚</li>
<li>å¸¸è§é—®é¢˜ï¼šåˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„æ—¥å¿—ã€ä»»åŠ¡çŠ¶æ€å’Œæ•°æ®æµä½¿å¾—é—®é¢˜æ’æŸ¥æ›´åŠ å›°éš¾ã€‚</li>
</ol>
</li>
<li>æœ¬åœ°æ‰§è¡Œæ¨¡å¼çš„è®¾è®¡<ol>
<li>åŠŸèƒ½ï¼šMapReduce æä¾›äº†ä¸€ç§ æœ¬åœ°æ‰§è¡Œçš„æ›¿ä»£å®ç°ï¼Œåœ¨å•å°æœºå™¨ä¸Šé¡ºåºæ‰§è¡Œæ•´ä¸ª MapReduce æ“ä½œã€‚</li>
<li>ç‰¹ç‚¹ï¼šæ‰€æœ‰ä»»åŠ¡æŒ‰é¡ºåºè¿è¡Œï¼Œæ— éœ€åˆ†å¸ƒå¼è°ƒåº¦ã€‚ç”¨æˆ·å¯ä»¥é™åˆ¶è®¡ç®—èŒƒå›´ï¼Œä»…è°ƒè¯•ç‰¹å®šçš„ map ä»»åŠ¡ã€‚</li>
</ol>
</li>
</ol>
<p><strong>Counter</strong></p>
<ul>
<li>Counters are used to track occurrences of specific events during a MapReduce operation, such as:<ul>
<li><strong>Custom events</strong> defined by the user (e.g., counting words, detecting specific patterns).</li>
<li><strong>System-defined metrics</strong>, like the number of input&#x2F;output key-value pairs processed.</li>
</ul>
</li>
</ul>
<p><strong>How Counters Work</strong></p>
<ul>
<li><strong>Propagation to the Master</strong>:<ul>
<li>Counter values from individual workers are sent to the <strong>master node</strong> via <strong>ping responses</strong>.</li>
</ul>
</li>
<li><strong>Aggregation</strong>:<ul>
<li>The master aggregates counter values from all completed tasks.</li>
<li>It ensures <strong>no double counting</strong> by ignoring duplicate task executions (e.g., due to re-executions or backup tasks).</li>
</ul>
</li>
</ul>
<p><strong>Monitoring and Reporting</strong></p>
<ul>
<li><strong>Real-Time Monitoring</strong>:<ul>
<li>The current counter values are displayed on the <strong>master status page</strong>, allowing users to observe the progress of the computation.</li>
</ul>
</li>
<li><strong>Final Reporting</strong>:<ul>
<li>When the MapReduce job finishes, the aggregated counter values are returned to the user program.</li>
</ul>
</li>
</ul>
<h1 id="Questions"><a href="#Questions" class="headerlink" title="Questions"></a>Questions</h1><p><strong>Assuming M&#x3D;10 and R&#x3D;20, What is the total number of files produced by the mappers?</strong></p>
<p>Total Files &#x3D; MÃ—R &#x3D; 10Ã—20 &#x3D; 200</p>
<p><strong>Why does MapReduce store the output of Reduce in the Google File System?</strong> </p>
<ul>
<li><p><strong>High Availability</strong>: GFS provides fault tolerance by replicating data across multiple machines. This ensures the output is not lost if a machine fails.</p>
</li>
<li><p><strong>Scalability</strong>: GFS is designed to handle large-scale data storage, making it suitable for the massive outputs of MapReduce jobs.</p>
</li>
</ul>
<p><strong>What is the purpose of a straggler?</strong> </p>
<ul>
<li><strong>â€œStragglerâ€ refers to</strong> <strong>slow-running</strong> <strong>tasks</strong>, often map or reduce tasks, that significantly delay the completion of a MapReduce job.</li>
<li>Solution:</li>
<li><ul>
<li><strong>Backup Execution</strong>: The master node schedules backup executions of straggler tasks on other available workers.</li>
</ul>
</li>
</ul>
<p><strong>True or False: One may use SQL++ with a CSV data file and no schema.</strong></p>
<p>True: SQL++ can operate on semi-structured data, including CSV files, without requiring a predefined schema.</p>
<p><strong>With SQL++, what is the difference between pivot and unpivot?</strong></p>
<p>Pivot:</p>
<ul>
<li><p><strong>Purpose</strong>: Transforms rows into attributes (columns).</p>
</li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><p>Input: <code>[ { &quot;symbol&quot;: &quot;amzn&quot;, &quot;price&quot;: 1900 }, { &quot;symbol&quot;: &quot;goog&quot;, &quot;price&quot;: 1120 }, { &quot;symbol&quot;: &quot;fb&quot;, &quot;price&quot;: 180 } ]</code></p>
</li>
<li><p>Query: <code>PIVOT sp.price AT sp.symbol FROM today_stock_prices sp;</code></p>
</li>
<li><p>Output: <code>{ &quot;amzn&quot;: 1900, &quot;goog&quot;: 1120, &quot;fb&quot;: 180 }</code></p>
</li>
</ul>
</li>
</ul>
<p>Unpivot:</p>
<ul>
<li><p><strong>Purpose</strong>: Transforms attributes (columns) into rows.</p>
</li>
<li><p><strong>Example</strong>:</p>
<ul>
<li><p>Input: <code>{ &quot;date&quot;: &quot;4/1/2019&quot;, &quot;amzn&quot;: 1900, &quot;goog&quot;: 1120, &quot;fb&quot;: 180 }</code></p>
</li>
<li><p>Query: <code>UNPIVOT c AS price AT sym FROM closing_prices c WHERE sym != &#39;date&#39;;</code></p>
</li>
<li><p>Output: <code>[ { &quot;date&quot;: &quot;4/1/2019&quot;, &quot;symbol&quot;: &quot;amzn&quot;, &quot;price&quot;: 1900 }, { &quot;date&quot;: &quot;4/1/2019&quot;, &quot;symbol&quot;: &quot;goog&quot;, &quot;price&quot;: 1120 }, { &quot;date&quot;: &quot;4/1/2019&quot;, &quot;symbol&quot;: &quot;fb&quot;, &quot;price&quot;: 180 } ]</code></p>
</li>
</ul>
</li>
</ul>
<p><strong>Using BG, one may summarize the performance of a data store using its SoAR. What is the input to BG to compute the SoAR of a data store?</strong></p>
<h3 id="1-SLA-Specifications"><a href="#1-SLA-Specifications" class="headerlink" title="1. SLA Specifications"></a><strong>1.</strong> <strong>SLA Specifications</strong></h3><p>The Service Level Agreement (SLA) defines the conditions under which SoAR is computed. The SLA includes:</p>
<ul>
<li><strong>Î±:</strong> Percentage of requests that must observe a response time less than or equal to Î² (e.g., 95%).</li>
<li><strong>Î²:</strong> Maximum acceptable response time (e.g., 100 ms).</li>
<li><strong>Ï„:</strong> Maximum allowable percentage of requests that observe unpredictable (stale or inconsistent) data (e.g., 0.01%).</li>
<li><strong>Î”:</strong> Duration for which the SLA must be satisfied (e.g., 10 minutes).</li>
</ul>
<h3 id="2-Database-Configuration"><a href="#2-Database-Configuration" class="headerlink" title="2. Database Configuration"></a><strong>2. Database Configuration</strong></h3><p>Details about the data store being tested:</p>
<ul>
<li><strong>Logical Schema:</strong> The data model used by the data store (e.g., relational schema, JSON-like schema for NoSQL).</li>
<li><strong>Physical Setup:</strong> Hardware configuration, including:<ul>
<li>Number of nodes.</li>
<li>Storage and memory resources.</li>
<li>Networking capabilities.</li>
</ul>
</li>
<li><strong>Population Size:</strong><ul>
<li><strong>M:</strong> Number of members in the database.</li>
<li><strong>Ï•:</strong> Number of friends per member.</li>
<li><strong>Ï:</strong> Number of resources per member.</li>
</ul>
</li>
</ul>
<h3 id="3-Workload-Parameters"><a href="#3-Workload-Parameters" class="headerlink" title="3. Workload Parameters"></a><strong>3. Workload Parameters</strong></h3><p>The workload specifies the nature and intensity of the actions BG will simulate:</p>
<ul>
<li><strong>Mix of</strong> <strong>Actions</strong><strong>:</strong><ul>
<li>Types of social networking actions (e.g., View Profile, List Friends, View Friend Requests).</li>
<li>Percentage of each action type (read-heavy, write-heavy, or mixed workloads).</li>
</ul>
</li>
<li><strong>Think Time (Ïµ):</strong><ul>
<li>The delay between consecutive actions performed by a single thread.</li>
</ul>
</li>
<li><strong>Inter-Arrival Time (Ïˆ):</strong><ul>
<li>The delay between new user sessions.</li>
</ul>
</li>
</ul>
<h3 id="4-Environmental-Parameters"><a href="#4-Environmental-Parameters" class="headerlink" title="4. Environmental Parameters"></a><strong>4. Environmental Parameters</strong></h3><p>Details about how BG generates and manages workloads:</p>
<ul>
<li><strong>Number of BGClients (N):</strong> Instances responsible for generating requests.</li>
<li><strong>Number of Threads (T):</strong> Concurrency level (threads per BGClient).</li>
<li><strong>D-Zipfian Distribution Parameters (Î¸):</strong><ul>
<li>Defines the access pattern (e.g., frequency of popular vs. less popular data).</li>
</ul>
</li>
</ul>
<p><strong>Consider the following binary representation of the priority of a key-value pair, 00101001. What is its CAMP rounding with precision 4?</strong></p>
<p>00101000</p>
<p><img src="/../../images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/bg_bm_rounding.png" alt="img"></p>
<p><strong>What is a thundering herd and how does the IQ framework prevent it from causing the persistent data store to become the bottleneck?</strong></p>
<p>Thundering Herd Problem:</p>
<ul>
<li>When a key-value pair is not found in the KVS (a <strong>KVS miss</strong>), multiple read sessions might simultaneously query the RDBMS to fetch the value.</li>
<li>This can overload the RDBMS and degrade performance under high concurrency.</li>
</ul>
<p>Solution:</p>
<ul>
<li>When the first read session encounters a KVS miss, it requests an I lease for the key.</li>
<li>Once the I lease is granted, the KVS prevents other read sessions from querying the RDBMS for the same key.</li>
<li>All other read sessions must â€œback offâ€ and wait for the value to be updated in the KVS by the session holding the I lease.</li>
</ul>
<blockquote>
<p>A thundering herd happens when a specific key undergoes heavy read and write activity.</p>
<ul>
<li>Writes invalidate the cache repeatedly  </li>
<li>All reads are forced to query the database</li>
</ul>
<p>I lease solves this problem</p>
<ul>
<li>The first read for the specific key is granted the I lease  </li>
<li>All other reads observe a miss and back-off  </li>
<li>The read with the I lease queries the RDBMS, computes the missing value, and populates the cache  </li>
<li>All other reads observe a cache hit</li>
</ul>
</blockquote>
<p>Reference: <a target="_blank" rel="noopener" href="https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/mapreduce-osdi04.pdf">https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/mapreduce-osdi04.pdf</a></p>
</div>

<div id="zh-content" class="lang-content" style="display: none;"><p>åœ¨æµ·é‡æ•°æ®ç¯å¢ƒä¸‹ï¼Œé«˜æ•ˆã€å¯é åœ°è¿›è¡Œæ‰¹å¤„ç†åˆ†ææ˜¯å·¥ç¨‹ä¸ç§‘ç ”å¸¸è§çš„éœ€æ±‚ã€‚MapReduce ä»¥æç®€çš„ <strong>Map&#x2F;Reduce</strong> åŒå‡½æ•°æ¨¡å‹ï¼ŒæŠŠå¤æ‚çš„æ•°æ®æµæ°´çº¿æ‹†è§£æˆå¯å¹¶è¡Œã€å¯æ¢å¤çš„å°ä»»åŠ¡ï¼Œå¹¶é€šè¿‡æ•°æ®æœ¬åœ°åŒ–ã€ä»»åŠ¡å¤åˆ¶ç­‰æœºåˆ¶ï¼Œåœ¨ä¸Šåƒå°æœºå™¨ä¸Šå®ç°äº†é«˜ååã€å¼ºå®¹é”™çš„ç¦»çº¿è®¡ç®—ã€‚</p>
<h1 id="æ ¸å¿ƒç¼–ç¨‹æ¨¡å‹"><a href="#æ ¸å¿ƒç¼–ç¨‹æ¨¡å‹" class="headerlink" title="æ ¸å¿ƒç¼–ç¨‹æ¨¡å‹"></a>æ ¸å¿ƒç¼–ç¨‹æ¨¡å‹</h1><p>MapReduce çš„æ ¸å¿ƒåªåŒ…å«ä¸¤ç±»ç”¨æˆ·å‡½æ•°ï¼š</p>
<ul>
<li><strong>Map</strong> æ¥æ”¶å•æ¡è¾“å…¥é”®&#x2F;å€¼å¯¹ï¼Œè¾“å‡ºè‹¥å¹² <em>ä¸­é—´</em> é”®&#x2F;å€¼å¯¹ï¼Œå¯é‡å¤é”®å€¼ä»¥æ”¯æŒåˆ†ç»„ã€‚</li>
<li><strong>Reduce</strong> æŒ‰ä¸­é—´é”®èšé›†æ¥è‡ªæ‰€æœ‰ Map ä»»åŠ¡çš„å€¼åˆ—è¡¨ï¼Œå¹¶å°†å…¶å½’å¹¶ä¸ºæ›´å°çš„ç»“æœé›†ï¼Œé€šå¸¸æ˜¯ä¸€æ¡æˆ–é›¶æ¡è®°å½•ã€‚</li>
</ul>
<p>æ¡†æ¶è´Ÿè´£æŠŠåŒé”®æ•°æ®è·¯ç”±ç»™åŒä¸€ä¸ª Reduceï¼Œå¹¶é€šè¿‡è¿­ä»£å™¨æµå¼ä¼ è¾“ï¼Œé¿å…å†…å­˜ç“¶é¢ˆã€‚æ‹†åˆ†-å½’å¹¶çš„æ¨¡å¼å¤©ç„¶æ”¯æŒå¯ä¼¸ç¼©æ€§ï¼šæ›´å¤šæœºå™¨æ„å‘³ç€æ›´å¤šåŒæ—¶æ‰§è¡Œçš„ Map&#x2F;Reduce å®ä¾‹ï¼Œååéšä¹‹æå‡ã€‚</p>
<h1 id="æ‰§è¡Œæµç¨‹è¯¦è§£"><a href="#æ‰§è¡Œæµç¨‹è¯¦è§£" class="headerlink" title="æ‰§è¡Œæµç¨‹è¯¦è§£"></a>æ‰§è¡Œæµç¨‹è¯¦è§£</h1><h3 id="1-è¾“å…¥åˆ‡åˆ†ä¸ä»»åŠ¡å¯åŠ¨"><a href="#1-è¾“å…¥åˆ‡åˆ†ä¸ä»»åŠ¡å¯åŠ¨" class="headerlink" title="1. è¾“å…¥åˆ‡åˆ†ä¸ä»»åŠ¡å¯åŠ¨"></a>1. è¾“å…¥åˆ‡åˆ†ä¸ä»»åŠ¡å¯åŠ¨</h3><p>MapReduce åº“è¯»å–ä½äº GFS ä¸Šçš„åŸå§‹æ–‡ä»¶ï¼Œå°†å…¶åˆ‡åˆ†æˆ 16 MB~64 MB çš„ç‰‡æ®µï¼›åˆ†ç‰‡å¤§å°ä¸ GFS å—ä¸€è‡´ï¼Œä»¥ä¾¿æŠŠè®¡ç®—å°½é‡è°ƒåº¦åˆ°æœ¬åœ°æŒæœ‰å‰¯æœ¬çš„èŠ‚ç‚¹ã€‚éšåï¼Œç”¨æˆ·ç¨‹åºçš„å¤šä»½å‰¯æœ¬åœ¨é›†ç¾¤ä¸­å¯åŠ¨ï¼Œå…¶ä¸­ä¸€ä»½å……å½“ <strong>Master</strong>ï¼Œå…¶ä½™ä¸º <strong>Worker</strong>ã€‚</p>
<h3 id="2-Map-é˜¶æ®µ"><a href="#2-Map-é˜¶æ®µ" class="headerlink" title="2. Map é˜¶æ®µ"></a>2. Map é˜¶æ®µ</h3><p>æ¯ä¸ª Map Worker è¯»å–è‡ªå·±çš„è¾“å…¥ç‰‡æ®µï¼Œæ‰§è¡Œç”¨æˆ· Map é€»è¾‘ï¼ŒæŠŠç»“æœæš‚å­˜æœ¬åœ°ç£ç›˜ï¼Œå¹¶æŒ‰ <strong>partition(key) &#x3D; hash(key) mod R</strong> åˆ†æˆ R ä¸ªæ¡¶ã€‚åˆ†æ¡¶å…ƒæ•°æ®åŒæ­¥ç»™ Masterï¼Œä¾›åç»­ Reduce æ‹‰å–ã€‚</p>
<h3 id="3-Shuffle-ä¸-Sort"><a href="#3-Shuffle-ä¸-Sort" class="headerlink" title="3. Shuffle ä¸ Sort"></a>3. Shuffle ä¸ Sort</h3><p>Reduce Worker é€šè¿‡ RPC ä»å„ Map èŠ‚ç‚¹æŠ“å–å±äºè‡ªèº«åˆ†åŒºçš„æ•°æ®ï¼Œå…ˆåœ¨å†…å­˜ã€ååœ¨ç£ç›˜è¿›è¡Œå½’å¹¶æ’åºï¼Œä¿è¯åŒé”®è®°å½•è¿ç»­ã€‚</p>
<h3 id="4-Reduce-é˜¶æ®µä¸è¾“å‡º"><a href="#4-Reduce-é˜¶æ®µä¸è¾“å‡º" class="headerlink" title="4. Reduce é˜¶æ®µä¸è¾“å‡º"></a>4. Reduce é˜¶æ®µä¸è¾“å‡º</h3><p>Reduce ä¾æ¬¡éå†æ’åºåçš„é”®åˆ†ç»„ï¼Œå°†æ¯ç»„ã€ˆkey, value listã€‰å–‚ç»™ç”¨æˆ· Reduce å‡½æ•°ï¼›è¾“å‡ºæœ€ç»ˆå†™å…¥ R ä¸ªç»“æœæ–‡ä»¶ï¼Œç›´æ¥å­˜æ”¾åœ¨ GFS ä¸Šä»¥è·å¾—å‰¯æœ¬çº§é«˜å¯ç”¨ã€‚</p>
<p>ä¸‹å›¾å½¢è±¡å±•ç¤ºäº†ä¸Šè¿°ä¸ªæ­¥éª¤ï¼š</p>
<p><img src="/../../images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/mapred_exe_overview.png" alt="img"></p>
<h1 id="Master-ä¸å®¹é”™è®¾è®¡"><a href="#Master-ä¸å®¹é”™è®¾è®¡" class="headerlink" title="Master ä¸å®¹é”™è®¾è®¡"></a>Master ä¸å®¹é”™è®¾è®¡</h1><p>Master è·Ÿè¸ªæ¯ä¸ª Map&#x2F;Reduce ä»»åŠ¡çš„çŠ¶æ€ï¼ˆidle, in-progress, completedï¼‰ä¸æ‰€å± Worker IDã€‚å®ƒå®šæœŸ ping Workerï¼›è‹¥è¶…æ—¶åˆ™è®¤ä¸ºèŠ‚ç‚¹å¤±æ•ˆï¼š</p>
<ul>
<li><strong>Map</strong> å·²å®Œæˆæˆ–è¿›è¡Œä¸­ä»»åŠ¡éƒ½è¢«é‡ç½®ä¸º idle å¹¶é‡æ–°è°ƒåº¦ï¼Œå› ä¸ºä¸­é—´æ–‡ä»¶ä»…å­˜æœ¬åœ°ç£ç›˜ã€‚</li>
<li><strong>Reduce</strong> å·²å®Œæˆä»»åŠ¡ä¸éœ€é‡è·‘ï¼Œè¾“å‡ºå·²å†™ GFSï¼›è¿›è¡Œä¸­ä»»åŠ¡å¯åœ¨æ–°æ•°æ®å°±ç»ªåç»§ç»­ã€‚</li>
<li>é‡æ–°æ‰§è¡Œçš„ Map ä¼šæŠŠæ–°æ–‡ä»¶ä½ç½®å¹¿æ’­ç»™æ‰€æœ‰ Reduceï¼Œç¡®ä¿å°šæœªæŠ“å–çš„èŠ‚ç‚¹è¯»å–æ­£ç¡®å‰¯æœ¬ã€‚</li>
</ul>
<p>å°½ç®¡å¯ä»¥é€šè¿‡æ—¥å¿—æ£€æŸ¥ç‚¹é‡å¯ Masterï¼ŒGoogle è®ºæ–‡çš„å®ç°ç®€åŒ–ä¸ºâ€œMaster æŒ‚äº†å°±æ•´ä½“é‡è·‘â€ï¼Œå®é™…éƒ¨ç½²ä¸­ï¼ˆHadoopã€Colossusï¼‰å·²æ¼”è¿›åˆ°å¤š Master è®¾è®¡ã€‚</p>
<h1 id="æ€§èƒ½ä¼˜åŒ–è¦è¯€"><a href="#æ€§èƒ½ä¼˜åŒ–è¦è¯€" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–è¦è¯€"></a>æ€§èƒ½ä¼˜åŒ–è¦è¯€</h1><h3 id="æ•°æ®æœ¬åœ°åŒ–"><a href="#æ•°æ®æœ¬åœ°åŒ–" class="headerlink" title="æ•°æ®æœ¬åœ°åŒ–"></a>æ•°æ®æœ¬åœ°åŒ–</h3><p>é›†ç¾¤å¸¦å®½å®è´µï¼Œä¼˜å…ˆæŠŠ Map è°ƒåº¦åˆ°å­˜æœ‰æ•°æ®å—å‰¯æœ¬çš„æœºå™¨ï¼›è‹¥ä¸å¯ç”¨ï¼Œåˆ™é€‰åŒæœºæ¶èŠ‚ç‚¹ï¼Œæ˜¾è‘—å‡å°‘ç½‘ç»œæµé‡ã€‚</p>
<h3 id="ä»»åŠ¡ç²’åº¦"><a href="#ä»»åŠ¡ç²’åº¦" class="headerlink" title="ä»»åŠ¡ç²’åº¦"></a>ä»»åŠ¡ç²’åº¦</h3><p>æŠŠ Mã€R è®¾æˆè¿œå¤§äºæœºå™¨æ•°ï¼Œå¯æå‡è´Ÿè½½å‡è¡¡ä¸å¤±æ•ˆæ¢å¤é€Ÿåº¦ï¼›Google å¤§è§„æ¨¡ä½œä¸šå¸¸ç”¨ Mâ‰ˆ200 Kã€Râ‰ˆ5 K å¯¹ 2 K å°æœºå™¨ã€‚</p>
<h3 id="Straggler-ä¸å¤‡ä»½ä»»åŠ¡"><a href="#Straggler-ä¸å¤‡ä»½ä»»åŠ¡" class="headerlink" title="Straggler ä¸å¤‡ä»½ä»»åŠ¡"></a>Straggler ä¸å¤‡ä»½ä»»åŠ¡</h3><p>æå°‘æ•°æ‹–æ…¢æ•´ä½“å®Œæˆæ—¶é—´çš„ Straggler ä¼šåœ¨ä½œä¸šæœ«æœŸè§¦å‘ <strong>backup execution</strong>ï¼šMaster ä¸ºæœªå®Œæˆä»»åŠ¡å†èµ·ä¸€åˆ°ä¸¤ä¸ªå‰¯æœ¬ï¼Œè°å…ˆç»“æŸä¾¿è®¤å®šæˆåŠŸï¼Œä»…è€—è´¹å‡ ä¸ªç™¾åˆ†ç‚¹èµ„æºï¼Œå³å¯å¤§å¹…å‹ç¼©å°¾éƒ¨å»¶è¿Ÿã€‚</p>
<h3 id="Combiner"><a href="#Combiner" class="headerlink" title="Combiner"></a>Combiner</h3><p>å½“ä¸­é—´é”®é‡åº¦é‡å¤ï¼ˆå¦‚ WordCountï¼‰æ—¶ï¼Œå¯åœ¨ Mapper ä¾§å¼•å…¥ä¸ Reduce åŒé€»è¾‘çš„ <strong>Combiner</strong>ï¼Œå…ˆæŠŠã€ˆthe, 1ã€‰â€¦ åˆå¹¶ä¸ºã€ˆthe, Nã€‰ï¼Œç½‘ç»œæ•°æ®é‡éª¤å‡ã€‚</p>
<h3 id="è®¡æ•°å™¨ä¸ç›‘æ§"><a href="#è®¡æ•°å™¨ä¸ç›‘æ§" class="headerlink" title="è®¡æ•°å™¨ä¸ç›‘æ§"></a>è®¡æ•°å™¨ä¸ç›‘æ§</h3><p>æ¡†æ¶è‡ªå¸¦ <strong>Counter</strong> æœºåˆ¶ï¼šWorker åœ¨ ping å“åº”ä¸­ä¸ŠæŠ¥å±€éƒ¨è®¡æ•°ï¼ŒMaster èšåˆå¹¶å»é‡åå±•ç¤ºåœ¨ Web çŠ¶æ€é¡µï¼Œä¾¿äºå®æ—¶æŒæ¡ä»»åŠ¡è¿›åº¦ä¸å¼‚å¸¸ã€‚</p>
<h3 id="è·³è¿‡åè®°å½•"><a href="#è·³è¿‡åè®°å½•" class="headerlink" title="è·³è¿‡åè®°å½•"></a>è·³è¿‡åè®°å½•</h3><p>è‹¥æŸæ¡è¾“å…¥åå¤è§¦å‘ç¬¬ä¸‰æ–¹åº“ segfaultï¼Œå¯å¯ç”¨ â€œskip bad recordsâ€ï¼šWorker åœ¨ä¿¡å·å¤„ç†å™¨å†…è®°å½•å´©æºƒåºå·ï¼›å‡ºç°å¤šæ¬¡å Master æŒ‡ç¤ºä¸‹æ¬¡ç›´æ¥è·³è¿‡ï¼Œä¿éšœä½œä¸šæ•´ä½“å®Œæˆã€‚</p>
<h1 id="é«˜çº§æœºåˆ¶"><a href="#é«˜çº§æœºåˆ¶" class="headerlink" title="é«˜çº§æœºåˆ¶"></a>é«˜çº§æœºåˆ¶</h1><ul>
<li><strong>åˆ†åŒºå‡½æ•°å®šåˆ¶</strong>ï¼šé»˜è®¤å“ˆå¸Œè¶³ä»¥å¹³è¡¡è´Ÿè½½ï¼Œä½†ç”¨æˆ·å¯æŒ‰ URL ä¸»æœºç­‰è¯­ä¹‰è‡ªå®šä¹‰ï¼Œä»¥ç¡®ä¿ç›¸å…³æ•°æ®æ±‡èšåŒä¸€ Reduce é€»è¾‘ã€‚</li>
<li><strong>è¾“å…¥&#x2F;è¾“å‡ºæ ¼å¼</strong>ï¼šHadoop çš„ TextInputFormat ä¿è¯åˆ‡åˆ†å‘ç”Ÿåœ¨è¡Œè¾¹ç•Œï¼Œç”¨æˆ·äº¦å¯è‡ªå®ç° Reader ä»¥å¤„ç†æ•°æ®åº“ç­‰éæ–‡ä»¶æ¥æºã€‚</li>
<li><strong>æœ¬åœ°è°ƒè¯•æ¨¡å¼</strong>ï¼šä¸ºé™ä½åˆ†å¸ƒå¼æ’éšœæˆæœ¬ï¼Œå¯åœ¨å•æœºé¡ºåºè·‘å®Œæ•´ä½œä¸šï¼Œæˆ–ä»…é‡æ”¾æŒ‡å®š Map åˆ†ç‰‡ï¼Œè°ƒè¯•ä½“éªŒä¸æ™®é€šç¨‹åºæ— å¼‚ã€‚</li>
<li><strong>I-lease ä¸ Thundering Herd</strong>ï¼šåœ¨é«˜å¹¶å‘ç¼“å­˜åœºæ™¯ä¸­ï¼Œå¯ç»™é¦–ä¸ª KVS æœªå‘½ä¸­è¯·æ±‚é¢å‘ <strong>I-lease</strong>ï¼Œå…¶ä»–è¯·æ±‚é€€é¿ï¼Œé¿å…å¯¹åç«¯æ•°æ®åº“é€ æˆâ€œæƒŠç¾¤æ•ˆåº”â€ã€‚</li>
</ul>
<h1 id="å…¸å‹é—®ç­”å›é¡¾"><a href="#å…¸å‹é—®ç­”å›é¡¾" class="headerlink" title="å…¸å‹é—®ç­”å›é¡¾"></a>å…¸å‹é—®ç­”å›é¡¾</h1><table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>è§£ç­”</th>
</tr>
</thead>
<tbody><tr>
<td><strong>M &#x3D; 10ï¼ŒR &#x3D; 20 æ—¶ Mapper äº§ç”Ÿæ–‡ä»¶æ•°ï¼Ÿ</strong></td>
<td>10 Ã— 20 &#x3D; 200 ä¸ªä¸­é—´æ–‡ä»¶ï¼ˆæ¯ä¸ª Map å¯¹æ¯ä¸ª Reduce ä¸€ä»½ï¼‰ã€‚</td>
</tr>
<tr>
<td><strong>ä¸ºä½• Reduce è¾“å‡ºè½ç›˜åˆ° GFSï¼Ÿ</strong></td>
<td>GFS é€šè¿‡ä¸‰å‰¯æœ¬æä¾›æ•…éšœæ¢å¤ä¸”å¯æ¨ªå‘æ‰©å®¹ï¼Œé€‚åˆä½œä¸šçº§è¾“å‡ºã€‚</td>
</tr>
<tr>
<td><strong>Straggler çš„å«ä¹‰ä¸è§£å†³ï¼Ÿ</strong></td>
<td>ææ…¢ä»»åŠ¡æ‹–å»¶ä½œä¸šå°¾æœŸï¼›Master ä¸ºå…¶å¯åŠ¨å¤‡ä»½å®ä¾‹ï¼Œå…ˆå®Œæˆè€…èƒœã€‚</td>
</tr>
<tr>
<td><strong>SQL++ æ˜¯å¦èƒ½ç›´æ¥æŸ¥è¯¢æ— æ¨¡å¼ CSVï¼Ÿ</strong></td>
<td>å¯ä»¥ï¼›SQL++ é¢å‘åŠç»“æ„åŒ–æ•°æ®ï¼Œå¤©ç„¶æ”¯æŒ CSV ç­‰è‡ªæè¿°æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td><strong>Pivot &#x2F; Unpivot å·®å¼‚ï¼Ÿ</strong></td>
<td>Pivot æŠŠè¡Œè½¬åˆ—ï¼›Unpivot æŠŠåˆ—è½¬è¡Œï¼Œå¸¸ç”¨äºçµæ´»é€è§†è¡¨åˆ†æã€‚</td>
</tr>
<tr>
<td><strong>BG è®¡ç®— SoAR çš„å¿…è¦è¾“å…¥ï¼Ÿ</strong></td>
<td>SLA å‚æ•°ã€æ•°æ®åº“é…ç½®ã€å·¥ä½œè´Ÿè½½ä¸ç”Ÿæˆå™¨å¹¶å‘åº¦ç­‰å››å¤§ç±»ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><strong>CAMP ç²¾åº¦ 4 å–æ•´ç¤ºä¾‹ 00101001â†’ï¼Ÿ</strong></td>
<td>00101000ã€‚<br><img src="/../../images/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/bg_bm_rounding.png" alt="img"></td>
</tr>
<tr>
<td><strong>Thundering Herd å¦‚ä½•è¢« I-lease é¿å…ï¼Ÿ</strong></td>
<td>é¦–ä¸ª miss è·å¾— I-lease è®¿é—® DB å¹¶å›å¡«ç¼“å­˜ï¼Œå…¶ä½™è¯·æ±‚é€€é¿ç­‰å¾…ç¼“å­˜å‘½ä¸­ã€‚</td>
</tr>
</tbody></table>
<p>å‚è€ƒæ–‡çŒ®ï¼š<a target="_blank" rel="noopener" href="https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/mapreduce-osdi04.pdf">https://static.googleusercontent.com/media/research.google.com/zh-CN//archive/mapreduce-osdi04.pdf</a></p>
</div>
    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/2024/11/15/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/SQL++/" rel="prev" title="SQL++">
      <i class="fa fa-chevron-left"></i> SQL++
    </a></div>
      <div class="post-nav-item">
    <a href="/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/2025/01/13/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E5%B8%83%E5%B1%80/" rel="next" title="æ•°æ®å­˜å‚¨å¸ƒå±€">
      æ•°æ®å­˜å‚¨å¸ƒå±€ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Programming-Model"><span class="nav-number">1.</span> <span class="nav-text">Programming Model</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Implementation"><span class="nav-number">2.</span> <span class="nav-text">Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Master-Data-Structure"><span class="nav-number">2.1.</span> <span class="nav-text">Master Data Structure</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Fault-Tolerance"><span class="nav-number">2.2.</span> <span class="nav-text">Fault Tolerance</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Locality-%E6%95%B0%E6%8D%AE%E6%9C%AC%E5%9C%B0%E5%8C%96%E4%BC%98%E5%8C%96"><span class="nav-number">2.3.</span> <span class="nav-text">Locality æ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Task-Granularity"><span class="nav-number">2.4.</span> <span class="nav-text">Task Granularity</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Backup-Tasks"><span class="nav-number">2.5.</span> <span class="nav-text">Backup Tasks</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Refinement"><span class="nav-number">3.</span> <span class="nav-text">Refinement</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Questions"><span class="nav-number">4.</span> <span class="nav-text">Questions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-SLA-Specifications"><span class="nav-number">4.0.1.</span> <span class="nav-text">1. SLA Specifications</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Database-Configuration"><span class="nav-number">4.0.2.</span> <span class="nav-text">2. Database Configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Workload-Parameters"><span class="nav-number">4.0.3.</span> <span class="nav-text">3. Workload Parameters</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Environmental-Parameters"><span class="nav-number">4.0.4.</span> <span class="nav-text">4. Environmental Parameters</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-number">5.</span> <span class="nav-text">æ ¸å¿ƒç¼–ç¨‹æ¨¡å‹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3"><span class="nav-number">6.</span> <span class="nav-text">æ‰§è¡Œæµç¨‹è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%BE%93%E5%85%A5%E5%88%87%E5%88%86%E4%B8%8E%E4%BB%BB%E5%8A%A1%E5%90%AF%E5%8A%A8"><span class="nav-number">6.0.1.</span> <span class="nav-text">1. è¾“å…¥åˆ‡åˆ†ä¸ä»»åŠ¡å¯åŠ¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Map-%E9%98%B6%E6%AE%B5"><span class="nav-number">6.0.2.</span> <span class="nav-text">2. Map é˜¶æ®µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Shuffle-%E4%B8%8E-Sort"><span class="nav-number">6.0.3.</span> <span class="nav-text">3. Shuffle ä¸ Sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-Reduce-%E9%98%B6%E6%AE%B5%E4%B8%8E%E8%BE%93%E5%87%BA"><span class="nav-number">6.0.4.</span> <span class="nav-text">4. Reduce é˜¶æ®µä¸è¾“å‡º</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Master-%E4%B8%8E%E5%AE%B9%E9%94%99%E8%AE%BE%E8%AE%A1"><span class="nav-number">7.</span> <span class="nav-text">Master ä¸å®¹é”™è®¾è®¡</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E8%A6%81%E8%AF%80"><span class="nav-number">8.</span> <span class="nav-text">æ€§èƒ½ä¼˜åŒ–è¦è¯€</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%9C%AC%E5%9C%B0%E5%8C%96"><span class="nav-number">8.0.1.</span> <span class="nav-text">æ•°æ®æœ¬åœ°åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1%E7%B2%92%E5%BA%A6"><span class="nav-number">8.0.2.</span> <span class="nav-text">ä»»åŠ¡ç²’åº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Straggler-%E4%B8%8E%E5%A4%87%E4%BB%BD%E4%BB%BB%E5%8A%A1"><span class="nav-number">8.0.3.</span> <span class="nav-text">Straggler ä¸å¤‡ä»½ä»»åŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Combiner"><span class="nav-number">8.0.4.</span> <span class="nav-text">Combiner</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A1%E6%95%B0%E5%99%A8%E4%B8%8E%E7%9B%91%E6%8E%A7"><span class="nav-number">8.0.5.</span> <span class="nav-text">è®¡æ•°å™¨ä¸ç›‘æ§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%B3%E8%BF%87%E5%9D%8F%E8%AE%B0%E5%BD%95"><span class="nav-number">8.0.6.</span> <span class="nav-text">è·³è¿‡åè®°å½•</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E6%9C%BA%E5%88%B6"><span class="nav-number">9.</span> <span class="nav-text">é«˜çº§æœºåˆ¶</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B8%E5%9E%8B%E9%97%AE%E7%AD%94%E5%9B%9E%E9%A1%BE"><span class="nav-number">10.</span> <span class="nav-text">å…¸å‹é—®ç­”å›é¡¾</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Yihang Wei</p>
  <div class="site-description" itemprop="description">èšç„¦äºä¸ªäººçš„å­¦ä¹ ä¸æˆé•¿å†ç¨‹ï¼Œæ—¨åœ¨ç³»ç»Ÿè®°å½•åœ¨åç«¯å¼€å‘ã€æ•°æ®åº“ç­‰é¢†åŸŸçš„æ¢ç´¢ä¸å®è·µã€‚</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">38</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>ç®€ä½“ä¸­æ–‡</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="">
      
        <option value="zh-CN" data-href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/2024/11/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/MapReduce/" selected="">
          ç®€ä½“ä¸­æ–‡
        </option>
      
        <option value="en" data-href="/en/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/2024/11/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/MapReduce/" selected="">
          English
        </option>
      
    </select>
  </div>

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yihang Wei</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '50%',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: '#fff',
  backgroundColor: '#fff',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'æ˜æš—',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>

</body>
</html>
